---
title: "HIGGS"
output: html_document
---

## Load libraries

  glmnet used for feature selection.
  modelr used for data splitting.
  tidymodels used for roc curve.
  tidyverse used for tibble.

```{r}
library(glmnet)
library(modelr)
library(tidymodels)
library(tidyverse)

set.seed(0)
```

## Parse dataset

  Data is stored in csv file.
  
  Loads all rows of csv file,
  without X column (which just stores row index)

```{r}
higgs <- read.csv("../data/higgs.csv") %>% subset(select = -X)
head(higgs)
```

## Split into train/test sets

  Train set is 70% of data.
  Test set is 30% of data.

```{r}
rp <- resample_partition(higgs, c(train = 0.7, test = 0.3))

train <- as_tibble(rp$train)
test <- as_tibble(rp$test)
```

## Feature selection

  All but "jet.3.eta" and "jet.4.eta" are important variables.

```{r}
x <- model.matrix(signal ~ ., data = train)
y <- train$signal
en_fit <- cv.glmnet(x, y, alpha = 0.5)

coef(en_fit, s = "lambda.min")
```

## Preliminary model fitting

### Logistic Regression

```{r}
glm_fit <- glm(signal ~ . - jet.3.eta - jet.4.eta, data = train, family = binomial)
train_glm <- train %>% 
    add_predictions(glm_fit) %>% 
    mutate(prob = exp(pred)/ (1 + exp(pred)), pred.signal = ifelse(prob > 0.5, 1, 0))
train_glm %>% count(signal, pred.signal) %>% spread(signal, n)
autoplot(roc_curve(train_glm, as.factor(signal), prob))
```

